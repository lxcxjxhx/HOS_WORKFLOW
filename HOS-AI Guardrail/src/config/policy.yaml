# HOS-AI 围栏策略配置

# 默认策略
default:
  input:
    # 指令注入检测规则
    prompt_injection:
      enabled: true
      keywords: ["忽略之前的指令", "系统提示", "prompt", "system prompt", "重置", "清空", "override"]
      action: block
      answer: "抱歉，您的请求包含不安全内容，无法处理。"
    # 敏感信息检测规则
    sensitive_info:
      enabled: true
      patterns:
        - '[1-9]\d{5}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]'
        - '1[3-9]\d{9}'
        - '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}'
        - '身份证号'
        - '手机号'
        - '邮箱'
      action: block
      answer: "抱歉，您的请求包含敏感信息，无法处理。"
    # 合规性检查规则
    compliance:
      enabled: true
      keywords: ["赌博", "色情", "毒品", "恐怖主义", "分裂", "违法"]
      action: block
      answer: "抱歉，您的请求涉及违规内容，无法处理。"
  output:
    # 模型输出违规内容检测
    output_compliance:
      enabled: true
      keywords: ["赌博", "色情", "毒品", "恐怖主义", "分裂", "违法"]
      action: block
      answer: "抱歉，根据安全规则，无法提供相关内容。"
    # 模型幻觉检测
    hallucination:
      enabled: false
      action: rewrite
      answer: "根据现有信息，无法确认该内容的准确性。"
