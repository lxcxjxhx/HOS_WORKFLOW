app:
  description: è‡ªåŠ¨åŒ–å·¥ä½œæµé…ç½®æ‰‹å†Œ
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: è‡ªåŠ¨åŒ–å·¥ä½œæµé…ç½®æ‰‹å†Œ
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: bowenliang123/md_exporter:3.2.0@b3075f474341eaf9f98ff773d684dc779c0b228f5da09b55eb773dcb5421d947
    version: null
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/deepseek:0.0.9@8cc65e3d2ce11b03d377ee008dc699c7016601c2646a09c983fcf7c1fd7827ee
    version: null
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/openai:0.2.8@aae2be0913b8c6f0b80cff58e08d7a8b4c214569b41778413fcaea204561ff16
    version: null
kind: app
version: 0.5.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      - .MD
      - .TXT
      - .DOCX
      - .PDF
      allowed_file_types:
      - image
      - document
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: true
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: start
        targetType: document-extractor
      id: 1769050927522-source-1769052674744-target
      selected: false
      source: '1769050927522'
      sourceHandle: source
      target: '1769052674744'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: end
      id: 1769053963253-source-1769052218754-target
      selected: false
      source: '1769053963253'
      sourceHandle: source
      target: '1769052218754'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769052162508-source-1769068037267-target
      selected: false
      source: '1769052162508'
      sourceHandle: source
      target: '1769068037267'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1769068037267-source-1769053676751-target
      selected: false
      source: '1769068037267'
      sourceHandle: source
      target: '1769053676751'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1769068037267-source-1769053793268-target
      selected: false
      source: '1769068037267'
      sourceHandle: source
      target: '1769053793268'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769053676751-source-1769068500001-target
      selected: false
      source: '1769053676751'
      sourceHandle: source
      target: '1769068500001'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1769068500001-source-1769053793268-target
      selected: false
      source: '1769068500001'
      sourceHandle: source
      target: '1769053793268'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769053793268-source-17690724131850-target
      selected: false
      source: '1769053793268'
      sourceHandle: source
      target: '17690724131850'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 17690724131850-source-1769073297193-target
      source: '17690724131850'
      sourceHandle: source
      target: '1769073297193'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 1769073297193-true-1769053833970-target
      selected: false
      source: '1769073297193'
      sourceHandle: 'true'
      target: '1769053833970'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769053833970-source-17690724163040-target
      selected: false
      source: '1769053833970'
      sourceHandle: source
      target: '17690724163040'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 17690724163040-source-1769053876253-target
      selected: false
      source: '17690724163040'
      sourceHandle: source
      target: '1769053876253'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769053876253-source-17690724297200-target
      selected: false
      source: '1769053876253'
      sourceHandle: source
      target: '17690724297200'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        id: 17690724131850-source-1769053876253-target
        isInLoop: false
        source: '17690724131850'
        sourceHandle: source
        sourceType: code
        target: '1769053876253'
        targetHandle: target
        targetType: llm
        type: custom
        zIndex: 0
      sourceHandle: source
      targetHandle: target
      type: custom
    - data:
        id: 1769073297193-yaml-1769074567890-target
        isInLoop: false
        source: '1769073297193'
        sourceHandle: yaml
        sourceType: if-else
        target: '1769074567890'
        targetHandle: target
        targetType: llm
        type: custom
        zIndex: 0
      sourceHandle: source
      targetHandle: target
      type: custom
    - data:
        id: 1769074567890-source-1769075678901-target
        isInLoop: false
        source: '1769074567890'
        sourceHandle: source
        sourceType: llm
        target: '1769075678901'
        targetHandle: target
        targetType: code
        type: custom
        zIndex: 0
      sourceHandle: source
      targetHandle: target
      type: custom
    - data:
        id: 1769075678901-source-1769053963253-target
        isInLoop: false
        source: '1769075678901'
        sourceHandle: source
        sourceType: code
        target: '1769053963253'
        targetHandle: target
        targetType: tool
        type: custom
        zIndex: 0
      sourceHandle: source
      targetHandle: target
      type: custom
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 17690724131850-source-1769053876253-target
      source: '17690724131850'
      sourceHandle: source
      target: '1769053876253'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: if-else
      id: 1769050927522-source-1769073297193-target
      source: '1769050927522'
      sourceHandle: source
      target: '1769073297193'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: if-else
      id: 1769050927522-source-1769094201733-target
      source: '1769050927522'
      sourceHandle: source
      target: '1769094201733'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 17690724297200-source-1769094201733-target
      selected: false
      source: '17690724297200'
      sourceHandle: source
      target: '1769094201733'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769074567890-source-1769075678901-target
      source: '1769074567890'
      sourceHandle: source
      target: '1769075678901'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: end
      id: 1769075678901-source-1769094370285-target
      source: '1769075678901'
      sourceHandle: source
      target: '1769094370285'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: tool
      id: 1769094201733-false-1769053963253-target
      source: '1769094201733'
      sourceHandle: 'false'
      target: '1769053963253'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: knowledge-retrieval
      id: 1769094201733-true-1769148240708-target
      source: '1769094201733'
      sourceHandle: 'true'
      target: '1769148240708'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: knowledge-retrieval
        targetType: llm
      id: 1769148240708-source-1769074567890-target
      source: '1769148240708'
      sourceHandle: source
      target: '1769074567890'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: llm
      id: 1769050927522-source-1769052162508-target
      source: '1769050927522'
      sourceHandle: source
      target: '1769052162508'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: document-extractor
        targetType: code
      id: 1769052674744-source-1769150000001-target
      source: '1769052674744'
      sourceHandle: source
      target: '1769150000001'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1769150000001-source-1769052162508-target
      source: '1769150000001'
      sourceHandle: source
      target: '1769052162508'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        selected: false
        title: ç”¨æˆ·è¾“å…¥
        type: start
        variables:
        - hint: ''
          label: MCPå¼€å…³
          max_length: 48
          options:
          - å¯ç”¨MCPæ¨¡å¼
          - ç¦ç”¨MCPæ¨¡å¼
          placeholder: ''
          required: true
          type: select
          variable: mode_MCP
        - hint: ''
          label: YAMLå¼€å…³
          max_length: 48
          options:
          - å¯ç”¨YAMLæ¨¡å¼
          - ç¦ç”¨YAMLæ¨¡å¼
          placeholder: ''
          required: true
          type: select
          variable: mode_YAML
        - default: ''
          hint: ''
          label: éœ€æ±‚æ®µè½
          max_length: 256
          options: []
          placeholder: ''
          required: false
          type: text-input
          variable: NEED_TEXT
        - allowed_file_extensions: []
          allowed_file_types:
          - document
          allowed_file_upload_methods:
          - local_file
          - remote_url
          default: ''
          hint: ''
          label: éœ€æ±‚æ–‡æ¡£
          max_length: 48
          options: []
          placeholder: ''
          required: false
          type: file
          variable: NEED_FILE
      height: 186
      id: '1769050927522'
      position:
        x: -360.52070549758207
        y: 732.3216377809192
      positionAbsolute:
        x: -360.52070549758207
        y: 732.3216377809192
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769150000001'
          - text
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          ambiguities:
            children:
              type: string
            type: array
          conflicts:
            children:
              type: string
            type: array
          final_content:
            children: null
            type: string
          has_enough_info:
            children: null
            type: boolean
          is_clear:
            children: null
            type: boolean
          is_complete:
            children: null
            type: boolean
        prompt_template:
        - id: d89962a0-8394-4a03-aec8-c0ff491d0a84
          role: system
          text: 'ä½ æ˜¯ä¸€ä¸ªéœ€æ±‚åˆ†æå¸ˆï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹éœ€æ±‚å†…å®¹ï¼Œç¡®ä¿å…¶å®Œæ•´æ€§å’Œæ¸…æ™°åº¦ã€‚å¦‚æœç”¨æˆ·æä¾›äº†éœ€æ±‚æ–‡æ¡£ï¼Œè¯·ä¼˜å…ˆä½¿ç”¨æ–‡æ¡£å†…å®¹ï¼›å¦‚æœæ²¡æœ‰ï¼Œè¯·ä½¿ç”¨éœ€æ±‚æ®µè½ã€‚åŒæ—¶åˆ©ç”¨çŸ¥è¯†æ£€ç´¢ç»“æœæ¥å®Œå–„éœ€æ±‚åˆ†æã€‚

            éœ€æ±‚æ–‡æ¡£å†…å®¹ï¼š{{#1769150000001.text#}}

            éœ€æ±‚æ®µè½ï¼š{{#1769050927522.NEED_TEXT#}}

            çŸ¥è¯†æ£€ç´¢ç»“æœï¼š


            é‡è¦è¯´æ˜ï¼š

            1. è¯·ä»”ç»†æ£€æŸ¥æ‰€æœ‰è¾“å…¥å†…å®¹ï¼Œå¦‚æœéœ€æ±‚æ–‡æ¡£å’Œéœ€æ±‚æ®µè½éƒ½ä¸ºç©ºï¼Œè¯·åˆ›å»ºä¸€ä¸ªç¤ºä¾‹éœ€æ±‚å†…å®¹ä½œä¸ºfinal_content

            2. æ— è®ºè¾“å…¥å¦‚ä½•ï¼Œå¿…é¡»ç¡®ä¿ç”Ÿæˆå®Œæ•´çš„final_contentå­—æ®µï¼Œä¸èƒ½ä¸ºç©º

            3. final_contentåº”è¯¥æ˜¯ä¸€ä¸ªç»“æ„åŒ–çš„éœ€æ±‚æè¿°ï¼ŒåŒ…å«å·¥ä½œæµçš„ä¸»è¦åŠŸèƒ½å’Œæµç¨‹


            è¯·æ£€æŸ¥ï¼š 1. éœ€æ±‚æ˜¯å¦å®Œæ•´ 2. éœ€æ±‚æ˜¯å¦æ¸…æ™° 3. æ˜¯å¦åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç”ŸæˆDify Workflow 4. æ˜¯å¦æœ‰ä»»ä½•æ­§ä¹‰æˆ–çŸ›ç›¾ä¹‹å¤„

            é‡è¦è¾“å‡ºè¦æ±‚ï¼š - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹ - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬ - ä¸è¦å¯¹ JSON è¿›è¡Œå­—ç¬¦ä¸²è½¬ä¹‰ - ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š
            {"is_complete": boolean, "is_clear": boolean, "has_enough_info": boolean,
            "ambiguities": [string], "conflicts": [string], "final_content": string} '
        selected: false
        structured_output_enabled: true
        title: æ£€æŸ¥
        type: llm
        vision:
          enabled: false
      height: 87
      id: '1769052162508'
      position:
        x: 38.072185119965866
        y: 498.4577679130033
      positionAbsolute:
        x: 38.072185119965866
        y: 498.4577679130033
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        outputs:
        - value_selector:
          - '1769053963253'
          - files
          value_type: array[file]
          variable: END_FILE
        selected: false
        title: æ‰‹å†Œè¾“å‡º
        type: end
      height: 87
      id: '1769052218754'
      position:
        x: 1082.3958442910928
        y: 1302.4243548915974
      positionAbsolute:
        x: 1082.3958442910928
        y: 1302.4243548915974
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        is_array_file: false
        selected: false
        title: æ–‡æ¡£æå–å™¨
        type: document-extractor
        variable_selector:
        - '1769050927522'
        - NEED_FILE
      height: 103
      id: '1769052674744'
      position:
        x: -360.52070549758207
        y: 648.7371946917017
      positionAbsolute:
        x: -360.52070549758207
        y: 648.7371946917017
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        code: "import json\n\ndef main(text: any) -> dict:\n    \"\"\"\n    å°†è¾“å…¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹\n\
          \    \"\"\"\n    # ç¡®ä¿textå§‹ç»ˆä¸ºå­—ç¬¦ä¸²ç±»å‹\n    if text is None:\n        string_text\
          \ = \"\"\n    elif isinstance(text, str):\n        string_text = text\n\
          \    else:\n        try:\n            # å°è¯•å°†éå­—ç¬¦ä¸²ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²\n            string_text\
          \ = str(text)\n        except:\n            # è½¬æ¢å¤±è´¥æ—¶ä½¿ç”¨ç©ºå­—ç¬¦ä¸²\n            string_text\
          \ = \"\"\n    \n    return {\"text\": string_text}\n"
        code_language: python3
        outputs:
          text:
            children: null
            type: string
        selected: false
        title: æ–‡æœ¬ç±»å‹è½¬æ¢
        type: code
        variables:
        - value_selector:
          - '1769052674744'
          - text
          variable: text
      height: 51
      id: '1769150000001'
      position:
        x: -360.52070549758207
        y: 550
      positionAbsolute:
        x: -360.52070549758207
        y: 550
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769068037267'
          - final_content
        model:
          completion_params: {}
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          ascii_flowchart:
            children: null
            type: string
          markdown_output:
            children: null
            type: string
          mermaid_flowchart:
            children: null
            type: string
        prompt_template:
        - id: f71a017e-4765-494b-8dee-f1674554b20c
          role: system
          text: 'ä½ æ˜¯ä¸€ä¸ªå·¥ä½œæµå¯è§†åŒ–ä¸“å®¶ï¼Œè¯·æ ¹æ®ä»¥ä¸‹éœ€æ±‚å†…å®¹ï¼Œç”Ÿæˆå¯¹åº”çš„å¯è§†åŒ–ç»“æ„å±‚è¾“å‡ºï¼š

            éœ€æ±‚å†…å®¹ï¼š{{#1769068037267.final_content#}}

            è¯·æŒ‰ç…§ä»¥ä¸‹è¦æ±‚ç”Ÿæˆè¾“å‡ºï¼š 1. é¦–å…ˆç”Ÿæˆä¸€ä¸ªä¼ªASCIIæµç¨‹å›¾ï¼Œå±•ç¤ºå·¥ä½œæµçš„æ•´ä½“æµè½¬ 2. ç„¶åç”Ÿæˆä¸€ä¸ªMermaidæµç¨‹å›¾ï¼Œæ”¯æŒclickè·³è½¬
            3. ç¡®ä¿æµç¨‹å›¾æ¸…æ™°å±•ç¤ºæ‰€æœ‰èŠ‚ç‚¹å’Œå®ƒä»¬ä¹‹é—´çš„è¿æ¥å…³ç³» 4. ä¸ºæ¯ä¸ªèŠ‚ç‚¹æ·»åŠ ç®€çŸ­çš„æè¿° 5. æ ¹æ®éœ€æ±‚å†…å®¹ç”Ÿæˆå¯¹åº”ç±»å‹çš„å·¥ä½œæµå¯è§†åŒ–ï¼Œå¦‚æ‰¹é‡æ–‡æ¡£å¤„ç†å·¥ä½œæµ

            é‡è¦è¾“å‡ºè¦æ±‚ï¼š - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹ - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬ - ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š {"ascii_flowchart":
            string, "markdown_output": string, "mermaid_flowchart": string} '
        selected: false
        structured_output_enabled: true
        title: å¯è§†åŒ–ç»“æ„å±‚
        type: llm
        vision:
          enabled: false
      height: 87
      id: '1769053676751'
      position:
        x: 563.5879295396928
        y: 355.39178469381335
      positionAbsolute:
        x: 563.5879295396928
        y: 355.39178469381335
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    result\
          \ = {\n        \"markdown_output\": str(data.get(\"markdown_output\", \"\
          \")),\n        \"ascii_flowchart\": str(data.get(\"ascii_flowchart\", \"\
          \")),\n        \"mermaid_flowchart\": str(data.get(\"mermaid_flowchart\"\
          , \"\")),\n    }\n\n    return result\n"
        code_language: python3
        is_team_authorization: true
        outputs:
          ascii_flowchart:
            children: null
            type: string
          markdown_output:
            children: null
            type: string
          mermaid_flowchart:
            children: null
            type: string
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769053676751'
          - text
          variable: raw_text
      height: 51
      id: '1769068500001'
      position:
        x: 563.5879295396928
        y: 438.0305053230396
      positionAbsolute:
        x: 563.5879295396928
        y: 438.0305053230396
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769068037267'
          - final_content
          - '1769068500001'
          - markdown_output
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          markdown_output:
            children: null
            type: string
        prompt_template:
        - id: a45d3b45-1d5f-42e4-b8c0-466d7784835e
          role: system
          text: 'ä½ æ˜¯ä¸€ä¸ªå·¥ä½œæµèŠ‚ç‚¹é…ç½®ä¸“å®¶ï¼Œè¯·æ ¹æ®ä»¥ä¸‹è¾“å…¥å†…å®¹ï¼Œç”Ÿæˆå¯¹åº”å·¥ä½œæµçš„èŠ‚ç‚¹é…ç½®å±‚è¯¦ç»†é…ç½®ï¼š

            å¯è§†åŒ–ç»“æ„å±‚è¾“å‡ºï¼š{{#1769068500001.markdown_output# || ''}}

            éœ€æ±‚å†…å®¹ï¼š{{#1769068037267.final_content#}}

            è¯·æŒ‰ç…§ä»¥ä¸‹è¦æ±‚ç”Ÿæˆæ¯ä¸ªèŠ‚ç‚¹çš„é…ç½®ï¼š 1. èŠ‚ç‚¹ç›®çš„ï¼šæè¿°èŠ‚ç‚¹çš„æ ¸å¿ƒåŠŸèƒ½å’Œä½œç”¨ 2. å…³é”®å‚æ•°ï¼šåˆ—å‡ºèŠ‚ç‚¹çš„ä¸»è¦é…ç½®å‚æ•° 3. è¾“å…¥ï¼šæè¿°èŠ‚ç‚¹æ¥æ”¶çš„è¾“å…¥å†…å®¹
            4. è¾“å‡ºï¼šæè¿°èŠ‚ç‚¹äº§ç”Ÿçš„è¾“å‡ºå†…å®¹ 5. ä¸Šä¸‹æ¸¸è¿æ¥å…³ç³»ï¼šè¯´æ˜èŠ‚ç‚¹çš„è¾“å…¥æ¥æºå’Œè¾“å‡ºå»å‘ 6. ä»…åœ¨éœ€è¦æ—¶æ ‡è®°éœ€è¦è‡ªå®šä¹‰å¼€å‘çš„ç‰¹æ®ŠèŠ‚ç‚¹

            é‡è¦è¾“å‡ºè¦æ±‚ï¼š - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹ - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬ - ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š {"nodes":
            [{"id": string, "title": string, "purpose": string, "key_parameters":
            [string], "input": string, "output": string, "upstream_connections": [string],
            "downstream_connections": [string], "is_mcp": boolean}], "markdown_output":
            string} '
        selected: false
        structured_output_enabled: true
        title: èŠ‚ç‚¹é…ç½®å±‚
        type: llm
        vision:
          enabled: false
      height: 87
      id: '1769053793268'
      position:
        x: 563.5879295396928
        y: 491.64216303195735
      positionAbsolute:
        x: 563.5879295396928
        y: 491.64216303195735
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769068037267'
          - final_content
          - '1769053793268'
          - markdown_output
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          markdown_output:
            children: null
            type: string
        prompt_template:
        - id: cfb873bb-b03d-4f26-a83f-6b25cc42fdf3
          role: system
          text: 'ä½ æ˜¯ä¸€ä¸ªDify Workflowç»“æ„ç¼–è¯‘å™¨ï¼Œè¯·æ ¹æ®ä»¥ä¸‹èŠ‚ç‚¹é…ç½®å±‚è¾“å‡ºï¼Œä¸ºæ ‡è®°ä¸ºMCPçš„èŠ‚ç‚¹ç”Ÿæˆå·¥ç¨‹çº§å¼€å‘å¤§çº²ï¼š

            èŠ‚ç‚¹é…ç½®å±‚è¾“å‡ºï¼š{{#1769053793268.markdown_output# || ''}}

            éœ€æ±‚å†…å®¹ï¼š{{#1769068037267.final_content#}}

            æ¨¡å¼é€‰æ‹©ï¼š{{#1769050927522.mode_MCP#}}

            è¯·æŒ‰ç…§ä»¥ä¸‹è¦æ±‚ç”Ÿæˆæ¯ä¸ªMCPèŠ‚ç‚¹çš„å¼€å‘å¤§çº²ï¼š 1. èŠ‚ç‚¹æ¦‚è¿°ï¼šæè¿°MCPèŠ‚ç‚¹çš„æ ¸å¿ƒåŠŸèƒ½å’Œå®šä½ 2. æŠ€æœ¯æ¶æ„ï¼šè®¾è®¡MCPèŠ‚ç‚¹çš„æŠ€æœ¯æ¶æ„ 3.
            APIè®¾è®¡ï¼šå®šä¹‰è¾“å…¥è¾“å‡ºæ¥å£ 4. å®ç°æ­¥éª¤ï¼šè¯¦ç»†çš„å¼€å‘æ­¥éª¤ 5. æµ‹è¯•ç­–ç•¥ï¼šå¦‚ä½•æµ‹è¯•MCPèŠ‚ç‚¹ 6. éƒ¨ç½²æ–¹æ¡ˆï¼šå¦‚ä½•éƒ¨ç½²å’Œé›†æˆåˆ°Dify
            7. ç»´æŠ¤å»ºè®®ï¼šåç»­ç»´æŠ¤å’Œå‡çº§å»ºè®®

            é‡è¦è¾“å‡ºè¦æ±‚ï¼š - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹ - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬ - ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š {"mcp_nodes":
            [{"id": string, "title": string, "overview": string, "technical_architecture":
            string, "api_design": string, "implementation_steps": [string], "testing_strategy":
            string, "deployment_plan": string, "maintenance_suggestions": string}],
            "markdown_output": string} '
        selected: false
        structured_output_enabled: true
        title: MCP å¼€å‘å±‚
        type: llm
        vision:
          enabled: false
      height: 87
      id: '1769053833970'
      position:
        x: 563.5879295396928
        y: 799.6461968374359
      positionAbsolute:
        x: 563.5879295396928
        y: 799.6461968374359
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769068500001'
          - markdown_output
          - '1769053793268'
          - markdown_output
          - '1769053833970'
          - markdown_output
          - '1769146109239'
          - results
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          final_markdown:
            children: null
            type: string
        prompt_template:
        - id: 2cdf4682-e9e3-402b-b7d3-3b0a2d0f4ffb
          role: system
          text: "ä½ æ˜¯ä¸€ä¸ªDify Workflowç»“æ„ç¼–è¯‘å™¨ï¼Œè¯·æ ¹æ®ä»¥ä¸‹å„å±‚è¾“å‡ºï¼ŒæŒ‰ç…§æŒ‡å®šçš„å†™ä½œæ ‡å‡†ç”Ÿæˆæœ€ç»ˆçš„å®Œæ•´è¾“å‡ºï¼š\nå¯è§†åŒ–ç»“æ„å±‚è¾“å‡ºï¼š{{#1769068500001.markdown_output#}}\n\
            \            èŠ‚ç‚¹é…ç½®å±‚è¾“å‡ºï¼š{{#1769053793268.markdown_output# || ''}}\nMCPå¼€å‘å±‚è¾“å‡ºï¼š{{#1769053833970.markdown_output#\
            \ || ''}} æ¨¡å¼é€‰æ‹©ï¼š{{#1769050927522.mode_MCP#}}\nè¯·æŒ‰ç…§ä»¥ä¸‹ç»“æ„å’Œå†™ä½œæ ‡å‡†ç”Ÿæˆæœ€ç»ˆè¾“å‡ºï¼š 1. æ•´ä½“éµå¾ªä¸‰å±‚é€’è¿›å¼ç”Ÿæˆæµæ°´çº¿ï¼šå¯è§†åŒ–ç»“æ„å±‚\
            \ â†’ èŠ‚ç‚¹é…ç½®å±‚ â†’ MCP/è‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘å±‚ 2.æ¯ä¸€å±‚å¼€å¤´è¯´æ˜'æœ¬å±‚è§£å†³ä»€ä¹ˆé—®é¢˜' 3. æ‰€æœ‰æŠ½è±¡ç‚¹å¿…é¡»ç»™å‡ºç¤ºä¾‹ 4. é¿å…è¥é”€è¯­è¨€ä¸ç©ºæ³›æ€»ç»“\
            \ 5. æ¯èŠ‚ç‚¹æè¿°ä¸å°‘äº200å­— 6. æ¯MCPå¤§çº²ä¸å°‘äº1000å­—7. æ€»å­—æ•°ä¸å°‘äº5000å­— 8. æ ¼å¼å¿…é¡»ä¸ºMarkdown 9.\
            \ åŒ…å«ä»¥ä¸‹ç« èŠ‚ï¼š\n   - Layer 1ï½œWorkflow å¯è§†åŒ–ç»“æ„\n- Layer 2ï½œèŠ‚ç‚¹å‚æ•°ä¸è¿æ¥é…ç½®\n   - Layer\
            \ 3ï½œMCP / è‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘å¤§çº²\n   - æ•´ä½“éƒ¨ç½²ä¸æ¼”è¿›å»ºè®®\n\né‡è¦è¾“å‡ºè¦æ±‚ï¼š\n   - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹\n\
            - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬\n- ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š\n{\"final_markdown\": string}\n"
        selected: false
        structured_output_enabled: true
        title: å†™ä½œæ ‡å‡† & è¾“å‡ºç»“æ„æ§åˆ¶
        type: llm
        vision:
          enabled: false
      height: 87
      id: '1769053876253'
      position:
        x: 977.1232375653808
        y: 462.9091927572484
      positionAbsolute:
        x: 977.1232375653808
        y: 462.9091927572484
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        is_team_authorization: true
        params:
          docx_template_file: ''
          md_text: '{{#17690724297200.final_markdown# || #1769075678901.final_yaml#}}'
          output_filename: '{{#1769050927522.mode_YAML# == "å¯ç”¨YAMLæ¨¡å¼" ? "dify_workflow.yml"
            : "dify_workflow_config"}}'
        plugin_id: bowenliang123/md_exporter
        plugin_unique_identifier: bowenliang123/md_exporter:3.2.0@b3075f474341eaf9f98ff773d684dc779c0b228f5da09b55eb773dcb5421d947
        provider_icon: http://localhost/console/api/workspaces/current/plugin/icon?tenant_id=a633b69c-9b5d-4769-b682-a66b28423d93&filename=f0bad95cda1671b4e49f0e05df6122ef9ec5d554e138f128795d11d3806c00ef.svg
        provider_id: bowenliang123/md_exporter/md_exporter
        provider_name: bowenliang123/md_exporter/md_exporter
        provider_type: builtin
        selected: false
        title: Markdown â®• DOCX
        tool_configurations: {}
        tool_description: å°† Markdown è½¬æ¢ä¸º DOCX æ–‡ä»¶çš„å·¥å…·
        tool_label: Markdown â®• DOCX
        tool_name: md_to_docx
        tool_node_version: '2'
        tool_parameters:
          docx_template_file:
            type: constant
            value: null
          md_text:
            type: mixed
            value: '{{#17690724297200.final_markdown# || #1769075678901.final_yaml#}}'
          output_filename:
            type: mixed
            value: '{{#1769050927522.mode_YAML# == "å¯ç”¨YAMLæ¨¡å¼" ? "dify_workflow.yml"
              : "dify_workflow_config"}}'
        type: tool
      height: 51
      id: '1769053963253'
      position:
        x: 1082.3958442910928
        y: 1249.3742750637334
      positionAbsolute:
        x: 1082.3958442910928
        y: 1249.3742750637334
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    result\
          \ = {\n        \"is_complete\": bool(data.get(\"is_complete\", False)),\n\
          \        \"is_clear\": bool(data.get(\"is_clear\", False)),\n        \"\
          has_enough_info\": bool(data.get(\"has_enough_info\", False)),\n       \
          \ \"ambiguities\": list(data.get(\"ambiguities\", [])),\n        \"conflicts\"\
          : list(data.get(\"conflicts\", [])),\n        \"final_content\": str(data.get(\"\
          final_content\", \"\")),\n    }\n\n    return result\n\n# Dify ä¼šè‡ªåŠ¨è°ƒç”¨ main\
          \ å‡½æ•°å¹¶ä¼ å…¥è¾“å…¥å˜é‡\n"
        code_language: python3
        outputs:
          ambiguities:
            children: null
            type: array[string]
          conflicts:
            children: null
            type: array[string]
          final_content:
            children: null
            type: string
          has_enough_info:
            children: null
            type: boolean
          is_clear:
            children: null
            type: boolean
          is_complete:
            children: null
            type: boolean
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769052162508'
          - text
          variable: raw_text
      height: 51
      id: '1769068037267'
      position:
        x: 38.072185119965866
        y: 586.3693287706064
      positionAbsolute:
        x: 38.072185119965866
        y: 586.3693287706064
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    final_markdown\
          \ = str(data.get(\"markdown_output\", \"\"))\n    \n    # æ·»åŠ é»˜è®¤å€¼ï¼Œç¡®ä¿ md_text\
          \ ä¸ä¸ºç©º\n    if not final_markdown:\n        final_markdown = \"# Dify Workflow\
          \ æŠ¥å‘Š\\n\\n## æŠ¥å‘Šå†…å®¹\\n\\nç”±äºè¾“å…¥å†…å®¹è¿‡äºç®€å•ï¼Œæ— æ³•ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šã€‚è¯·æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°ä»¥è·å–å®Œæ•´æŠ¥å‘Šã€‚\\n\\n## ç”Ÿæˆä¿¡æ¯\\\
          n\\n- ç”Ÿæˆæ—¶é—´ï¼šè‡ªåŠ¨ç”Ÿæˆ\\n- æŠ¥å‘Šç±»å‹ï¼šé»˜è®¤æ¨¡æ¿\\n- è¾“å…¥å†…å®¹ï¼šç®€åŒ–è¾“å…¥\" \n    \n    result = {\n \
          \       \"final_markdown\": final_markdown,\n    }\n\n    return result\n"
        code_language: python3
        is_team_authorization: true
        outputs:
          final_markdown:
            children: null
            type: string
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769053876253'
          - text
          variable: raw_text
      height: 51
      id: '17690724131850'
      position:
        x: 563.5879295396928
        y: 578.1116105581626
      positionAbsolute:
        x: 563.5879295396928
        y: 578.1116105581626
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    final_markdown\
          \ = str(data.get(\"markdown_output\", \"\"))\n    \n    # æ·»åŠ é»˜è®¤å€¼ï¼Œç¡®ä¿ md_text\
          \ ä¸ä¸ºç©º\n    if not final_markdown:\n        final_markdown = \"# Dify Workflow\
          \ æŠ¥å‘Š\\n\\n## æŠ¥å‘Šå†…å®¹\\n\\nç”±äºè¾“å…¥å†…å®¹æˆ–LLMè¾“å‡ºé—®é¢˜ï¼Œæ— æ³•ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šã€‚è¯·æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°ä»¥è·å–å®Œæ•´æŠ¥å‘Šã€‚\\n\\\
          n## ç”Ÿæˆä¿¡æ¯\\n\\n- ç”Ÿæˆæ—¶é—´ï¼šè‡ªåŠ¨ç”Ÿæˆ\\n- æŠ¥å‘Šç±»å‹ï¼šé»˜è®¤æ¨¡æ¿\\n- å¤„ç†çŠ¶æ€ï¼šå·²å¤„ç†\\n- è¾“å…¥æƒ…å†µï¼šå·²æ¥æ”¶\\n\\n##\
          \ è§£å†³å»ºè®®\\n\\n1. æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°\\n2. ç¡®ä¿è¾“å…¥æ ¼å¼ç¬¦åˆè¦æ±‚\\n3. æ£€æŸ¥LLMæ¨¡å‹é…ç½®\\n4. é‡è¯•ç”ŸæˆæŠ¥å‘Š\" \n\
          \    \n    result = {\n        \"final_markdown\": final_markdown,\n   \
          \ }\n\n    return result\n"
        code_language: python3
        is_team_authorization: true
        outputs:
          final_markdown:
            children: null
            type: string
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769053676751'
          - text
          variable: raw_text
      height: 51
      id: '17690724163040'
      position:
        x: 563.5879295396928
        y: 890.5481111786644
      positionAbsolute:
        x: 563.5879295396928
        y: 890.5481111786644
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    final_markdown\
          \ = str(data.get(\"final_markdown\", \"\"))\n    \n    # æ·»åŠ é»˜è®¤å€¼ï¼Œç¡®ä¿ md_text\
          \ ä¸ä¸ºç©º\n    if not final_markdown:\n        final_markdown = \"# Dify Workflow\
          \ æŠ¥å‘Š\\n\\n## æŠ¥å‘Šå†…å®¹\\n\\nç”±äºè¾“å…¥å†…å®¹æˆ–LLMè¾“å‡ºé—®é¢˜ï¼Œæ— æ³•ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šã€‚è¯·æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°ä»¥è·å–å®Œæ•´æŠ¥å‘Šã€‚\\n\\\
          n## ç”Ÿæˆä¿¡æ¯\\n\\n- ç”Ÿæˆæ—¶é—´ï¼šè‡ªåŠ¨ç”Ÿæˆ\\n- æŠ¥å‘Šç±»å‹ï¼šé»˜è®¤æ¨¡æ¿\\n- å¤„ç†çŠ¶æ€ï¼šå·²å¤„ç†\\n- è¾“å…¥æƒ…å†µï¼šå·²æ¥æ”¶\\n\\n##\
          \ è§£å†³å»ºè®®\\n\\n1. æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°\\n2. ç¡®ä¿è¾“å…¥æ ¼å¼ç¬¦åˆè¦æ±‚\\n3. æ£€æŸ¥LLMæ¨¡å‹é…ç½®\\n4. é‡è¯•ç”ŸæˆæŠ¥å‘Š\" \n\
          \    \n    result = {\n        \"final_markdown\": final_markdown,\n   \
          \ }\n\n    return result\n"
        code_language: python3
        is_team_authorization: true
        outputs:
          final_markdown:
            children: null
            type: string
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769053876253'
          - text
          variable: raw_text
      height: 51
      id: '17690724297200'
      position:
        x: 977.1232375653808
        y: 549.11322133593
      positionAbsolute:
        x: 977.1232375653808
        y: 549.11322133593
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            value: å¯ç”¨MCPæ¨¡å¼
            variable_selector:
            - '1769050927522'
            - mode_MCP
          id: 'true'
          logical_operator: and
        - case_id: 'false'
          conditions:
          - comparison_operator: is
            value: ç¦ç”¨MCPæ¨¡å¼
            variable_selector:
            - '1769050927522'
            - mode_MCP
          id: 'false'
          logical_operator: and
        default_next_node_id: '1769052218754'
        selected: false
        title: MCPæ¨¡å¼
        type: if-else
      height: 171
      id: '1769073297193'
      position:
        x: 563.5879295396928
        y: 629.1376528313453
      positionAbsolute:
        x: 563.5879295396928
        y: 629.1376528313453
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769068500001'
          - markdown_output
          - '1769053793268'
          - markdown_output
          - '1769053833970'
          - markdown_output
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          yaml_output:
            children: null
            type: string
        prompt_template:
        - id: 3c4a2b1d-5e6f-7g8h-9i0j-1k2l3m4n5o6p
          role: system
          text: 'ä½ æ˜¯Dify Workflow YAMLç”Ÿæˆä¸“å®¶ï¼Œæ ¹æ®ä»¥ä¸‹è¾“å‡ºç”Ÿæˆå®Œæ•´çš„æ‰¹é‡æ–‡æ¡£å¤„ç†å·¥ä½œæµYAMLï¼š

            è¾“å…¥éœ€æ±‚å†…å®¹ï¼š{{#1769068037267.final_content# || ''}} å¯è§†åŒ–ç»“æ„ï¼š{{#1769068500001.markdown_output#
            || ''}} èŠ‚ç‚¹é…ç½®ï¼š{{#1769053793268.markdown_output# || ''}} çŸ¥è¯†æ£€ç´¢ç»“æœï¼š{{#1769146109239.results#
            || ''}}

            è¦æ±‚ï¼š 1. ä¸¥æ ¼æŒ‰ç…§å®ç‰çš„è‹±è¯‘ä¸­ä¼˜åŒ–ç‰ˆ.ymlã€å®Œè›‹ï¼æˆ‘è¢«LLMåŒ…å›´äº†ï¼.ymlã€MCP.ymlç­‰èŒƒä¾‹æ–‡ä»¶çš„ç»“æ„ç”Ÿæˆ 2. ç”Ÿæˆå®Œæ•´çš„Dify
            YAMLï¼ŒåŒ…å«appã€kindã€versionã€workflowç­‰æ‰€æœ‰å¿…è¦éƒ¨åˆ† 3. éµå¾ªschema 0.5.0 4. è¯­æ³•æ­£ç¡®ï¼Œä½¿ç”¨2ç©ºæ ¼ç¼©è¿›
            5. å¯ç›´æ¥å¯¼å…¥Difyå¹³å°ä½¿ç”¨ 6. ä»…è¾“å‡ºçº¯YAMLï¼Œæ— é¢å¤–æ–‡æœ¬ï¼Œæ— ```yamlæ ‡è®° 7. ç”Ÿæˆæ‰¹é‡æ–‡æ¡£å¤„ç†å·¥ä½œæµï¼Œç”¨äºè‡ªåŠ¨ç”Ÿæˆå·¡æ£€æŠ¥å‘Š/å®æ–½æŠ¥å‘Š/é—®é¢˜æŠ¥å‘Š

            å…·ä½“è¦æ±‚ï¼š - appéƒ¨åˆ†ï¼šåŒ…å«descriptionã€iconã€icon_backgroundã€modeã€nameç­‰å­—æ®µ - kind:
            app - version: 0.1.0 - workflowéƒ¨åˆ†ï¼šåŒ…å«featuresã€graphï¼ˆedgeså’Œnodesï¼‰ç­‰ - èŠ‚ç‚¹é…ç½®ï¼šåŒ…å«å®Œæ•´çš„èŠ‚ç‚¹æ•°æ®å’Œè¿æ¥å…³ç³»
            - ä½¿ç”¨æ­£ç¡®çš„YAMLè¯­æ³•ï¼Œå¤šè¡Œå­—ç¬¦ä¸²ä½¿ç”¨|æ ‡è®° - é¿å…ä½¿ç”¨æœªè§£æçš„å˜é‡å¼•ç”¨ - ç¡®ä¿æ‰€æœ‰å­—æ®µéƒ½æœ‰åˆç†çš„å€¼ - åŒ…å«æ–‡æ¡£æå–å™¨ã€æŠ¥å‘Šç±»å‹åˆ†æã€æŠ¥å‘Šç”Ÿæˆç­‰æ ¸å¿ƒèŠ‚ç‚¹
            - æ”¯æŒæ‰¹é‡è¾“å…¥å’ŒæŠ¥å‘Šç±»å‹è·¯ç”± - ç¬¦åˆDify Workflowæ ¼å¼è§„èŒƒ

            è¯·æ ¹æ®è¾“å…¥çš„æ‰¹é‡æ–‡æ¡£å¤„ç†å·¥ä½œæµéœ€æ±‚ï¼Œç”Ÿæˆå¯ç›´æ¥ä½¿ç”¨çš„Dify Workflow YAMLæ–‡ä»¶ã€‚'
        selected: false
        structured_output_enabled: true
        title: YAMLå·¥ä½œæµç”Ÿæˆå™¨
        type: llm
        vision:
          enabled: false
      height: 87
      id: '1769074567890'
      position:
        x: 1082.3958442910928
        y: 926.1506328881483
      positionAbsolute:
        x: 1082.3958442910928
        y: 926.1506328881483
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        code: "import json\nimport re\n\n\ndef extract_yaml(text: str) -> str:\n \
          \   \"\"\"\n    ä»æ–‡æœ¬ä¸­æå–YAMLå†…å®¹\n    æ”¯æŒï¼š\n    - çº¯YAMLå­—ç¬¦ä¸²\n    - å¸¦æ ‡è®°çš„YAMLå—ï¼ˆå¦‚```yaml\
          \ ... ```ï¼‰\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n    \n    if not text:\n        return\
          \ \"\"\n    text = text.strip()\n    \n    # æƒ…å†µ1ï¼šå·²ç»æ˜¯çº¯YAML\n    try:\n  \
          \      True\n        return text\n    except:\n        pass\n    \n    #\
          \ æƒ…å†µ2ï¼šå¸¦æœ‰yamlæ ‡è®°\n    yaml_match = re.search(r'```yaml\\s*([\\s\\S]*?)\\s*```',\
          \ text, re.IGNORECASE)\n    if yaml_match:\n        yaml_content = yaml_match.group(1).strip()\n\
          \        try:\n            True\n            return yaml_content\n     \
          \   except:\n            pass\n    \n    # æƒ…å†µ3ï¼šå‰åæœ‰æ‚è´¨ï¼Œå°è¯•æå–yamlç»“æ„\n    yaml_start\
          \ = text.find('app:')\n    if yaml_start != -1:\n        yaml_candidate\
          \ = text[yaml_start:]\n        try:\n            True\n            return\
          \ yaml_candidate\n        except:\n            pass\n    \n    return text\n\
          \ndef main(raw_text: str):\n    \"\"\"\n    å¤„ç†LLMç”Ÿæˆçš„YAMLï¼Œç¡®ä¿æ ¼å¼æ­£ç¡®\n    \"\"\
          \"\n    # æå–YAML\n    yaml_content = extract_yaml(raw_text)\n    \n    #\
          \ åŸºæœ¬éªŒè¯å’Œä¿®å¤\n    if not yaml_content:\n        # ç”Ÿæˆé»˜è®¤YAMLæ¨¡æ¿\n        yaml_content\
          \ = \"\"\"\napp:\n  description: è‡ªåŠ¨ç”Ÿæˆçš„Difyå·¥ä½œæµ\n  icon: \U0001F916\n  icon_background:\
          \ '#FFEAD5'\n  mode: workflow\n  name: è‡ªåŠ¨ç”Ÿæˆå·¥ä½œæµ\n  use_icon_as_answer_icon:\
          \ false\ndependencies: []\nkind: app\nversion: 0.5.0\nworkflow:\n  conversation_variables:\
          \ []\n  environment_variables: []\n  features:\n    file_upload:\n     \
          \ allowed_file_extensions:\n      - .JPG\n      - .JPEG\n      - .PNG\n\
          \      - .GIF\n      - .WEBP\n      - .SVG\n      allowed_file_types:\n\
          \      - image\n      allowed_file_upload_methods:\n      - local_file\n\
          \      - remote_url\n      enabled: false\n      image:\n        enabled:\
          \ false\n        number_limits: 3\n        transfer_methods:\n        -\
          \ local_file\n        - remote_url\n      number_limits: 3\n    opening_statement:\
          \ ''\n    retriever_resource:\n      enabled: false\n    sensitive_word_avoidance:\n\
          \      enabled: false\n    speech_to_text:\n      enabled: false\n    suggested_questions:\
          \ []\n    suggested_questions_after_answer:\n      enabled: false\n    text_to_speech:\n\
          \      enabled: false\n      language: ''\n      voice: ''\n  graph:\n \
          \   edges: []\n    nodes: []\n    viewport:\n      x: 0\n      y: 0\n  \
          \    zoom: 1\n  rag_pipeline_variables: []\n            \"\"\"\n    \n \
          \   result = {\n        \"final_yaml\": yaml_content\n    }\n    return\
          \ result\n"
        code_language: python3
        is_team_authorization: true
        outputs:
          final_yaml:
            children: null
            type: string
        selected: false
        title: YAMLåå¤„ç†å™¨
        type: code
        variables:
        - value_selector:
          - '1769074567890'
          - text
          variable: raw_text
      height: 51
      id: '1769075678901'
      position:
        x: 1082.3958442910928
        y: 870.7043707060124
      positionAbsolute:
        x: 1082.3958442910928
        y: 870.7043707060124
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            value: å¯ç”¨YAMLæ¨¡å¼
            variable_selector:
            - '1769050927522'
            - mode_YAML
          id: 'true'
          logical_operator: and
        - case_id: 'false'
          conditions:
          - comparison_operator: is
            value: ç¦ç”¨YAMLæ¨¡å¼
            variable_selector:
            - '1769050927522'
            - mode_YAML
          id: 'false'
          logical_operator: and
        default_next_node_id: '1769052218754'
        selected: false
        title: YAMLæ¨¡å¼
        type: if-else
      height: 171
      id: '1769094201733'
      position:
        x: 743.9582009544303
        y: 1123.1937865344998
      positionAbsolute:
        x: 743.9582009544303
        y: 1123.1937865344998
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        outputs:
        - value_selector:
          - '1769075678901'
          - final_yaml
          value_type: string
          variable: YAML_OUTPUT
        selected: false
        title: YAMLæ–‡ä»¶è¾“å‡º
        type: end
      height: 87
      id: '1769094370285'
      position:
        x: 1082.3958442910928
        y: 777.1804087047515
      positionAbsolute:
        x: 1082.3958442910928
        y: 777.1804087047515
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    - data:
        dataset_ids:
        - CHiqEMjxow1iqexS8Vsv++eqVZ8IELOGXos5fodI7JXT1bgNUdJHu4hgSsQtkCN5
        multiple_retrieval_config:
          reranking_enable: false
          reranking_mode: weighted_score
          top_k: 4
          weights:
            keyword_setting:
              keyword_weight: 0
            vector_setting:
              embedding_model_name: text-embedding-3-large
              embedding_provider_name: langgenius/openai/openai
              vector_weight: 1
            weight_type: customized
        query_attachment_selector: []
        query_variable_selector: []
        retrieval_mode: multiple
        selected: true
        title: å·¥ä½œæµæ•°æ®é›†
        type: knowledge-retrieval
      height: 89
      id: '1769148240708'
      position:
        x: 1082.3958442910928
        y: 1013.1764126515723
      positionAbsolute:
        x: 1082.3958442910928
        y: 1013.1764126515723
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    viewport:
      x: 351.8813736528306
      y: -150.55878103301416
      zoom: 0.6597539553864473
  rag_pipeline_variables: []
