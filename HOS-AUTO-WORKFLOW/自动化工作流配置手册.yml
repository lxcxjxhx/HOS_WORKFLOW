app:
  description: è‡ªåŠ¨åŒ–å·¥ä½œæµé…ç½®æ‰‹å†Œ
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: è‡ªåŠ¨åŒ–å·¥ä½œæµé…ç½®æ‰‹å†Œ
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: bowenliang123/md_exporter:3.2.0@b3075f474341eaf9f98ff773d684dc779c0b228f5da09b55eb773dcb5421d947
    version: null
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/deepseek:0.0.9@8cc65e3d2ce11b03d377ee008dc699c7016601c2646a09c983fcf7c1fd7827ee
    version: null
kind: app
version: 0.5.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: start
        targetType: document-extractor
      id: 1769050927522-source-1769052674744-target
      selected: false
      source: '1769050927522'
      sourceHandle: source
      target: '1769052674744'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: document-extractor
        targetType: llm
      id: 1769052674744-source-1769052162508-target
      selected: false
      source: '1769052674744'
      sourceHandle: source
      target: '1769052162508'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: llm
      id: 1769050927522-source-1769052162508-target
      selected: false
      source: '1769050927522'
      sourceHandle: source
      target: '1769052162508'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: end
      id: 1769053963253-source-1769052218754-target
      selected: false
      source: '1769053963253'
      sourceHandle: source
      target: '1769052218754'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769052162508-source-1769068037267-target
      selected: false
      source: '1769052162508'
      sourceHandle: source
      target: '1769068037267'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1769068037267-source-1769053676751-target
      selected: false
      source: '1769068037267'
      sourceHandle: source
      target: '1769053676751'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1769068037267-source-1769053793268-target
      selected: false
      source: '1769068037267'
      sourceHandle: source
      target: '1769053793268'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769053676751-source-1769068500001-target
      selected: false
      source: '1769053676751'
      sourceHandle: source
      target: '1769068500001'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1769068500001-source-1769053793268-target
      selected: false
      source: '1769068500001'
      sourceHandle: source
      target: '1769053793268'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769053793268-source-17690724131850-target
      selected: false
      source: '1769053793268'
      sourceHandle: source
      target: '17690724131850'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 17690724131850-source-1769073297193-target
      source: '17690724131850'
      sourceHandle: source
      target: '1769073297193'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 1769073297193-true-1769053833970-target
      selected: false
      source: '1769073297193'
      sourceHandle: 'true'
      target: '1769053833970'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769053833970-source-17690724163040-target
      selected: false
      source: '1769053833970'
      sourceHandle: source
      target: '17690724163040'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 17690724163040-source-1769053876253-target
      selected: false
      source: '17690724163040'
      sourceHandle: source
      target: '1769053876253'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1769053876253-source-17690724297200-target
      selected: false
      source: '1769053876253'
      sourceHandle: source
      target: '17690724297200'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: tool
      id: 17690724297200-source-1769053963253-target
      selected: false
      source: '17690724297200'
      sourceHandle: source
      target: '1769053963253'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 17690724131850-source-1769053876253-target
      source: '17690724131850'
      sourceHandle: source
      target: '1769053876253'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        selected: true
        title: ç”¨æˆ·è¾“å…¥
        type: start
        variables:
        - allowed_file_extensions: []
          allowed_file_types:
          - document
          allowed_file_upload_methods:
          - local_file
          - remote_url
          default: ''
          hint: ''
          label: éœ€æ±‚æ–‡æ¡£
          max_length: 48
          options: []
          placeholder: ''
          required: false
          type: file
          variable: NEED_FILE
        - default: ç¦æ­¢MCP
          hint: ''
          label: æ¨¡å¼é€‰æ‹©
          max_length: 48
          options:
          - å¼•ç”¨MCP
          - ç¦æ­¢MCP
          placeholder: ''
          required: true
          type: select
          variable: mode
        - default: ''
          hint: ''
          label: éœ€æ±‚æ®µè½
          max_length: 256
          options: []
          placeholder: ''
          required: false
          type: text-input
          variable: NEED_TEXT
      height: 161
      id: '1769050927522'
      position:
        x: -321.1120747683117
        y: 623.1900449921706
      positionAbsolute:
        x: -321.1120747683117
        y: 623.1900449921706
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769052674744'
          - text
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          ambiguities:
            children:
              type: string
            type: array
          conflicts:
            children:
              type: string
            type: array
          final_content:
            children: null
            type: string
          has_enough_info:
            children: null
            type: boolean
          is_clear:
            children: null
            type: boolean
          is_complete:
            children: null
            type: boolean
        prompt_template:
        - id: d89962a0-8394-4a03-aec8-c0ff491d0a84
          role: system
          text: 'ä½ æ˜¯ä¸€ä¸ªéœ€æ±‚åˆ†æå¸ˆï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹éœ€æ±‚å†…å®¹ï¼Œç¡®ä¿å…¶å®Œæ•´æ€§å’Œæ¸…æ™°åº¦ã€‚å¦‚æœç”¨æˆ·æä¾›äº†éœ€æ±‚æ–‡æ¡£ï¼Œè¯·ä¼˜å…ˆä½¿ç”¨æ–‡æ¡£å†…å®¹ï¼›å¦‚æœæ²¡æœ‰ï¼Œè¯·ä½¿ç”¨éœ€æ±‚æ®µè½ã€‚

            éœ€æ±‚æ–‡æ¡£å†…å®¹ï¼š{{#1769052674744.text#}}

            éœ€æ±‚æ®µè½ï¼š{{#1769050927522.NEED_TEXT#}}


            é‡è¦è¯´æ˜ï¼š

            1. è¯·ä»”ç»†æ£€æŸ¥æ‰€æœ‰è¾“å…¥å†…å®¹ï¼Œå¦‚æœéœ€æ±‚æ–‡æ¡£å’Œéœ€æ±‚æ®µè½éƒ½ä¸ºç©ºï¼Œè¯·åˆ›å»ºä¸€ä¸ªç¤ºä¾‹éœ€æ±‚å†…å®¹ä½œä¸ºfinal_content

            2. æ— è®ºè¾“å…¥å¦‚ä½•ï¼Œå¿…é¡»ç¡®ä¿ç”Ÿæˆå®Œæ•´çš„final_contentå­—æ®µï¼Œä¸èƒ½ä¸ºç©º

            3. final_contentåº”è¯¥æ˜¯ä¸€ä¸ªç»“æ„åŒ–çš„éœ€æ±‚æè¿°ï¼ŒåŒ…å«å·¥ä½œæµçš„ä¸»è¦åŠŸèƒ½å’Œæµç¨‹


            è¯·æ£€æŸ¥ï¼š 1. éœ€æ±‚æ˜¯å¦å®Œæ•´ 2. éœ€æ±‚æ˜¯å¦æ¸…æ™° 3. æ˜¯å¦åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç”ŸæˆDify Workflow 4. æ˜¯å¦æœ‰ä»»ä½•æ­§ä¹‰æˆ–çŸ›ç›¾ä¹‹å¤„

            é‡è¦è¾“å‡ºè¦æ±‚ï¼š - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹ - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬ - ä¸è¦å¯¹ JSON è¿›è¡Œå­—ç¬¦ä¸²è½¬ä¹‰ - ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š
            {"is_complete": boolean, "is_clear": boolean, "has_enough_info": boolean,
            "ambiguities": [string], "conflicts": [string], "final_content": string} '
        selected: false
        structured_output_enabled: true
        title: æ£€æŸ¥
        type: llm
        vision:
          enabled: false
      height: 88
      id: '1769052162508'
      position:
        x: -66.51225796925175
        y: 390.24052690503936
      positionAbsolute:
        x: -66.51225796925175
        y: 390.24052690503936
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        outputs:
        - value_selector:
          - '1769053963253'
          - files
          value_type: array[file]
          variable: END_FILE
        selected: false
        title: è¾“å‡º
        type: end
      height: 88
      id: '1769052218754'
      position:
        x: 977.1232375653808
        y: 811.3357531450264
      positionAbsolute:
        x: 977.1232375653808
        y: 811.3357531450264
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        is_array_file: false
        selected: false
        title: æ–‡æ¡£æå–å™¨
        type: document-extractor
        variable_selector:
        - '1769050927522'
        - NEED_FILE
      height: 104
      id: '1769052674744'
      position:
        x: 169.72713001496706
        y: 644.1900449921706
      positionAbsolute:
        x: 169.72713001496706
        y: 644.1900449921706
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769068037267'
          - final_content
        model:
          completion_params: {}
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          ascii_flowchart:
            children: null
            type: string
          markdown_output:
            children: null
            type: string
          mermaid_flowchart:
            children: null
            type: string
        prompt_template:
        - id: f71a017e-4765-494b-8dee-f1674554b20c
          role: system
          text: 'ä½ æ˜¯ä¸€ä¸ªDify Workflowç»“æ„ç¼–è¯‘å™¨ï¼Œè¯·æ ¹æ®ä»¥ä¸‹éœ€æ±‚å†…å®¹ï¼Œç”Ÿæˆå¯è§†åŒ–ç»“æ„å±‚çš„è¾“å‡ºï¼š

            éœ€æ±‚å†…å®¹ï¼š{{#1769068037267.final_content#}}

            è¯·æŒ‰ç…§ä»¥ä¸‹è¦æ±‚ç”Ÿæˆè¾“å‡ºï¼š 1. é¦–å…ˆç”Ÿæˆä¸€ä¸ªä¼ªASCIIæµç¨‹å›¾ï¼Œå±•ç¤ºå·¥ä½œæµçš„æ•´ä½“æµè½¬ 2. ç„¶åç”Ÿæˆä¸€ä¸ªMermaidæµç¨‹å›¾ï¼Œæ”¯æŒclickè·³è½¬
            3. ç¡®ä¿æµç¨‹å›¾æ¸…æ™°å±•ç¤ºæ‰€æœ‰èŠ‚ç‚¹å’Œå®ƒä»¬ä¹‹é—´çš„è¿æ¥å…³ç³» 4. ä¸ºæ¯ä¸ªèŠ‚ç‚¹æ·»åŠ ç®€çŸ­çš„æè¿° 5. è¾“å‡ºæ ¼å¼åº”ä¸ºMarkdownï¼ŒåŒ…å«ASCIIæµç¨‹å›¾å’ŒMermaidä»£ç å—

            é‡è¦è¾“å‡ºè¦æ±‚ï¼š - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹ - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬ - ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š {"ascii_flowchart":
            string, "markdown_output": string, "mermaid_flowchart": string} '
        selected: false
        structured_output_enabled: true
        title: å¯è§†åŒ–ç»“æ„å±‚
        type: llm
        vision:
          enabled: false
      height: 88
      id: '1769053676751'
      position:
        x: 583.7463615443697
        y: 513.6149335781072
      positionAbsolute:
        x: 583.7463615443697
        y: 513.6149335781072
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    result\
          \ = {\n        \"markdown_output\": str(data.get(\"markdown_output\", \"\
          \")),\n        \"ascii_flowchart\": str(data.get(\"ascii_flowchart\", \"\
          \")),\n        \"mermaid_flowchart\": str(data.get(\"mermaid_flowchart\"\
          , \"\")),\n    }\n\n    return result\n"
        code_language: python3
        is_team_authorization: true
        outputs:
          ascii_flowchart:
            children: null
            type: string
          markdown_output:
            children: null
            type: string
          mermaid_flowchart:
            children: null
            type: string
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769053676751'
          - text
          variable: raw_text
      height: 52
      id: '1769068500001'
      position:
        x: 583.7463615443697
        y: 607.9869694279416
      positionAbsolute:
        x: 583.7463615443697
        y: 607.9869694279416
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769068037267'
          - final_content
          - '1769068500001'
          - markdown_output
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          markdown_output:
            children: null
            type: string
        prompt_template:
        - id: a45d3b45-1d5f-42e4-b8c0-466d7784835e
          role: system
          text: 'ä½ æ˜¯ä¸€ä¸ªDify Workflowç»“æ„ç¼–è¯‘å™¨ï¼Œè¯·æ ¹æ®ä»¥ä¸‹å¯è§†åŒ–ç»“æ„å±‚è¾“å‡ºï¼Œç”ŸæˆèŠ‚ç‚¹é…ç½®å±‚çš„è¯¦ç»†é…ç½®ï¼š

            å¯è§†åŒ–ç»“æ„å±‚è¾“å‡ºï¼š{{#1769068500001.markdown_output# || ''}}

            éœ€æ±‚å†…å®¹ï¼š{{#1769068037267.final_content#}}

            è¯·æŒ‰ç…§ä»¥ä¸‹è¦æ±‚ç”Ÿæˆæ¯ä¸ªèŠ‚ç‚¹çš„é…ç½®ï¼š 1. èŠ‚ç‚¹ç›®çš„ï¼šæè¿°èŠ‚ç‚¹çš„æ ¸å¿ƒåŠŸèƒ½å’Œä½œç”¨ 2. å…³é”®å‚æ•°ï¼šåˆ—å‡ºèŠ‚ç‚¹çš„ä¸»è¦é…ç½®å‚æ•° 3. è¾“å…¥ï¼šæè¿°èŠ‚ç‚¹æ¥æ”¶çš„è¾“å…¥å†…å®¹
            4. è¾“å‡ºï¼šæè¿°èŠ‚ç‚¹äº§ç”Ÿçš„è¾“å‡ºå†…å®¹ 5. ä¸Šä¸‹æ¸¸è¿æ¥å…³ç³»ï¼šè¯´æ˜èŠ‚ç‚¹çš„è¾“å…¥æ¥æºå’Œè¾“å‡ºå»å‘ 6. æ ‡è®°éœ€è¦è‡ªå®šä¹‰å¼€å‘çš„MCPèŠ‚ç‚¹

            é‡è¦è¾“å‡ºè¦æ±‚ï¼š - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹ - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬ - ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š {"nodes":
            [{"id": string, "title": string, "purpose": string, "key_parameters":
            [string], "input": string, "output": string, "upstream_connections": [string],
            "downstream_connections": [string], "is_mcp": boolean}], "markdown_output":
            string} '
        selected: false
        structured_output_enabled: true
        title: èŠ‚ç‚¹é…ç½®å±‚
        type: llm
        vision:
          enabled: false
      height: 88
      id: '1769053793268'
      position:
        x: 583.7463615443697
        y: 721.6386638300628
      positionAbsolute:
        x: 583.7463615443697
        y: 721.6386638300628
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769068037267'
          - final_content
          - '1769053793268'
          - markdown_output
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          markdown_output:
            children: null
            type: string
        prompt_template:
        - id: cfb873bb-b03d-4f26-a83f-6b25cc42fdf3
          role: system
          text: 'ä½ æ˜¯ä¸€ä¸ªDify Workflowç»“æ„ç¼–è¯‘å™¨ï¼Œè¯·æ ¹æ®ä»¥ä¸‹èŠ‚ç‚¹é…ç½®å±‚è¾“å‡ºï¼Œä¸ºæ ‡è®°ä¸ºMCPçš„èŠ‚ç‚¹ç”Ÿæˆå·¥ç¨‹çº§å¼€å‘å¤§çº²ï¼š

            èŠ‚ç‚¹é…ç½®å±‚è¾“å‡ºï¼š{{#1769053793268.markdown_output#}}

            éœ€æ±‚å†…å®¹ï¼š{{#1769068037267.final_content#}}

            æ¨¡å¼é€‰æ‹©ï¼š{{#1769050927522.mode#}}

            è¯·æŒ‰ç…§ä»¥ä¸‹è¦æ±‚ç”Ÿæˆæ¯ä¸ªMCPèŠ‚ç‚¹çš„å¼€å‘å¤§çº²ï¼š 1. èŠ‚ç‚¹æ¦‚è¿°ï¼šæè¿°MCPèŠ‚ç‚¹çš„æ ¸å¿ƒåŠŸèƒ½å’Œå®šä½ 2. æŠ€æœ¯æ¶æ„ï¼šè®¾è®¡MCPèŠ‚ç‚¹çš„æŠ€æœ¯æ¶æ„ 3.
            APIè®¾è®¡ï¼šå®šä¹‰è¾“å…¥è¾“å‡ºæ¥å£ 4. å®ç°æ­¥éª¤ï¼šè¯¦ç»†çš„å¼€å‘æ­¥éª¤ 5. æµ‹è¯•ç­–ç•¥ï¼šå¦‚ä½•æµ‹è¯•MCPèŠ‚ç‚¹ 6. éƒ¨ç½²æ–¹æ¡ˆï¼šå¦‚ä½•éƒ¨ç½²å’Œé›†æˆåˆ°Dify
            7. ç»´æŠ¤å»ºè®®ï¼šåç»­ç»´æŠ¤å’Œå‡çº§å»ºè®®

            é‡è¦è¾“å‡ºè¦æ±‚ï¼š - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹ - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬ - ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š {"mcp_nodes":
            [{"id": string, "title": string, "overview": string, "technical_architecture":
            string, "api_design": string, "implementation_steps": [string], "testing_strategy":
            string, "deployment_plan": string, "maintenance_suggestions": string}],
            "markdown_output": string} '
        selected: false
        structured_output_enabled: true
        title: MCP å¼€å‘å±‚
        type: llm
        vision:
          enabled: false
      height: 88
      id: '1769053833970'
      position:
        x: 574.1979455052656
        y: 1113.3995261050882
      positionAbsolute:
        x: 574.1979455052656
        y: 1113.3995261050882
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1769068500001'
          - markdown_output
          - '1769053793268'
          - markdown_output
          - '1769053833970'
          - markdown_output
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        outputs:
          final_markdown:
            children: null
            type: string
        prompt_template:
        - id: 2cdf4682-e9e3-402b-b7d3-3b0a2d0f4ffb
          role: system
          text: "ä½ æ˜¯ä¸€ä¸ªDify Workflowç»“æ„ç¼–è¯‘å™¨ï¼Œè¯·æ ¹æ®ä»¥ä¸‹å„å±‚è¾“å‡ºï¼ŒæŒ‰ç…§æŒ‡å®šçš„å†™ä½œæ ‡å‡†ç”Ÿæˆæœ€ç»ˆçš„å®Œæ•´è¾“å‡ºï¼š\nå¯è§†åŒ–ç»“æ„å±‚è¾“å‡ºï¼š{{#1769068500001.markdown_output#}}\n\
            \            èŠ‚ç‚¹é…ç½®å±‚è¾“å‡ºï¼š{{#1769053793268.markdown_output# || ''}}\nMCPå¼€å‘å±‚è¾“å‡ºï¼š{{#1769053833970.markdown_output#\
            \ || ''}} æ¨¡å¼é€‰æ‹©ï¼š{{#1769050927522.mode#}}\nè¯·æŒ‰ç…§ä»¥ä¸‹ç»“æ„å’Œå†™ä½œæ ‡å‡†ç”Ÿæˆæœ€ç»ˆè¾“å‡ºï¼š 1. æ•´ä½“éµå¾ªä¸‰å±‚é€’è¿›å¼ç”Ÿæˆæµæ°´çº¿ï¼šå¯è§†åŒ–ç»“æ„å±‚\
            \ â†’ èŠ‚ç‚¹é…ç½®å±‚ â†’ MCP/è‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘å±‚ 2.æ¯ä¸€å±‚å¼€å¤´è¯´æ˜'æœ¬å±‚è§£å†³ä»€ä¹ˆé—®é¢˜' 3. æ‰€æœ‰æŠ½è±¡ç‚¹å¿…é¡»ç»™å‡ºç¤ºä¾‹ 4. é¿å…è¥é”€è¯­è¨€ä¸ç©ºæ³›æ€»ç»“\
            \ 5. æ¯èŠ‚ç‚¹æè¿°ä¸å°‘äº200å­— 6. æ¯MCPå¤§çº²ä¸å°‘äº1000å­—7. æ€»å­—æ•°ä¸å°‘äº5000å­— 8. æ ¼å¼å¿…é¡»ä¸ºMarkdown 9.\
            \ åŒ…å«ä»¥ä¸‹ç« èŠ‚ï¼š\n   - Layer 1ï½œWorkflow å¯è§†åŒ–ç»“æ„\n- Layer 2ï½œèŠ‚ç‚¹å‚æ•°ä¸è¿æ¥é…ç½®\n   - Layer\
            \ 3ï½œMCP / è‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘å¤§çº²\n   - æ•´ä½“éƒ¨ç½²ä¸æ¼”è¿›å»ºè®®\n\né‡è¦è¾“å‡ºè¦æ±‚ï¼š\n   - åªè¾“å‡ºåˆæ³•JSONï¼Œä¸è¦ä½¿ç”¨```åŒ…è£¹\n\
            - ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡æœ¬\n- ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONç»“æ„è¾“å‡ºï¼š\n{\"final_markdown\": string}\n"
        selected: false
        structured_output_enabled: true
        title: å†™ä½œæ ‡å‡† & è¾“å‡ºç»“æ„æ§åˆ¶
        type: llm
        vision:
          enabled: false
      height: 88
      id: '1769053876253'
      position:
        x: 977.1232375653808
        y: 462.9091927572484
      positionAbsolute:
        x: 977.1232375653808
        y: 462.9091927572484
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        is_team_authorization: true
        params:
          docx_template_file: ''
          md_text: '{{#17690724297200.final_markdown#}}'
          output_filename: dify_workflow_config
        plugin_id: bowenliang123/md_exporter
        plugin_unique_identifier: bowenliang123/md_exporter:3.2.0@b3075f474341eaf9f98ff773d684dc779c0b228f5da09b55eb773dcb5421d947
        provider_icon: http://localhost/console/api/workspaces/current/plugin/icon?tenant_id=a633b69c-9b5d-4769-b682-a66b28423d93&filename=f0bad95cda1671b4e49f0e05df6122ef9ec5d554e138f128795d11d3806c00ef.svg
        provider_id: bowenliang123/md_exporter/md_exporter
        provider_name: bowenliang123/md_exporter/md_exporter
        provider_type: builtin
        selected: false
        title: Markdown â®• DOCX
        tool_configurations: {}
        tool_description: å°† Markdown è½¬æ¢ä¸º DOCX æ–‡ä»¶çš„å·¥å…·
        tool_label: Markdown â®• DOCX
        tool_name: md_to_docx
        tool_node_version: '2'
        tool_parameters:
          docx_template_file:
            type: constant
            value: null
          md_text:
            type: mixed
            value: '{{#17690724297200.final_markdown#}}'
          output_filename:
            type: mixed
            value: null
        type: tool
      height: 52
      id: '1769053963253'
      position:
        x: 977.1232375653808
        y: 644.1900449921706
      positionAbsolute:
        x: 977.1232375653808
        y: 644.1900449921706
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    result\
          \ = {\n        \"is_complete\": bool(data.get(\"is_complete\", False)),\n\
          \        \"is_clear\": bool(data.get(\"is_clear\", False)),\n        \"\
          has_enough_info\": bool(data.get(\"has_enough_info\", False)),\n       \
          \ \"ambiguities\": list(data.get(\"ambiguities\", [])),\n        \"conflicts\"\
          : list(data.get(\"conflicts\", [])),\n        \"final_content\": str(data.get(\"\
          final_content\", \"\")),\n    }\n\n    return result\n\n# Dify ä¼šè‡ªåŠ¨è°ƒç”¨ main\
          \ å‡½æ•°å¹¶ä¼ å…¥è¾“å…¥å˜é‡\n"
        code_language: python3
        outputs:
          ambiguities:
            children: null
            type: array[string]
          conflicts:
            children: null
            type: array[string]
          final_content:
            children: null
            type: string
          has_enough_info:
            children: null
            type: boolean
          is_clear:
            children: null
            type: boolean
          is_complete:
            children: null
            type: boolean
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769052162508'
          - text
          variable: raw_text
      height: 52
      id: '1769068037267'
      position:
        x: 237.69293221530205
        y: 296.6075091658131
      positionAbsolute:
        x: 237.69293221530205
        y: 296.6075091658131
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    final_markdown\
          \ = str(data.get(\"markdown_output\", \"\"))\n    \n    # æ·»åŠ é»˜è®¤å€¼ï¼Œç¡®ä¿ md_text\
          \ ä¸ä¸ºç©º\n    if not final_markdown:\n        final_markdown = \"# Dify Workflow\
          \ æŠ¥å‘Š\\n\\n## æŠ¥å‘Šå†…å®¹\\n\\nç”±äºè¾“å…¥å†…å®¹è¿‡äºç®€å•ï¼Œæ— æ³•ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šã€‚è¯·æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°ä»¥è·å–å®Œæ•´æŠ¥å‘Šã€‚\\n\\n## ç”Ÿæˆä¿¡æ¯\\\
          n\\n- ç”Ÿæˆæ—¶é—´ï¼šè‡ªåŠ¨ç”Ÿæˆ\\n- æŠ¥å‘Šç±»å‹ï¼šé»˜è®¤æ¨¡æ¿\\n- è¾“å…¥å†…å®¹ï¼šç®€åŒ–è¾“å…¥\" \n    \n    result = {\n \
          \       \"final_markdown\": final_markdown,\n    }\n\n    return result\n"
        code_language: python3
        is_team_authorization: true
        outputs:
          final_markdown:
            children: null
            type: string
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769053876253'
          - text
          variable: raw_text
      height: 52
      id: '17690724131850'
      position:
        x: 583.7463615443697
        y: 811.3357531450264
      positionAbsolute:
        x: 583.7463615443697
        y: 811.3357531450264
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    final_markdown\
          \ = str(data.get(\"markdown_output\", \"\"))\n    \n    # æ·»åŠ é»˜è®¤å€¼ï¼Œç¡®ä¿ md_text\
          \ ä¸ä¸ºç©º\n    if not final_markdown:\n        final_markdown = \"# Dify Workflow\
          \ æŠ¥å‘Š\\n\\n## æŠ¥å‘Šå†…å®¹\\n\\nç”±äºè¾“å…¥å†…å®¹æˆ–LLMè¾“å‡ºé—®é¢˜ï¼Œæ— æ³•ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šã€‚è¯·æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°ä»¥è·å–å®Œæ•´æŠ¥å‘Šã€‚\\n\\\
          n## ç”Ÿæˆä¿¡æ¯\\n\\n- ç”Ÿæˆæ—¶é—´ï¼šè‡ªåŠ¨ç”Ÿæˆ\\n- æŠ¥å‘Šç±»å‹ï¼šé»˜è®¤æ¨¡æ¿\\n- å¤„ç†çŠ¶æ€ï¼šå·²å¤„ç†\\n- è¾“å…¥æƒ…å†µï¼šå·²æ¥æ”¶\\n\\n##\
          \ è§£å†³å»ºè®®\\n\\n1. æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°\\n2. ç¡®ä¿è¾“å…¥æ ¼å¼ç¬¦åˆè¦æ±‚\\n3. æ£€æŸ¥LLMæ¨¡å‹é…ç½®\\n4. é‡è¯•ç”ŸæˆæŠ¥å‘Š\" \n\
          \    \n    result = {\n        \"final_markdown\": final_markdown,\n   \
          \ }\n\n    return result\n"
        code_language: python3
        is_team_authorization: true
        outputs:
          final_markdown:
            children: null
            type: string
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769053676751'
          - text
          variable: raw_text
      height: 52
      id: '17690724163040'
      position:
        x: 574.1979455052656
        y: 1228.552905510483
      positionAbsolute:
        x: 574.1979455052656
        y: 1228.552905510483
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\nimport re\n\ndef extract_json(text: str) -> dict:\n  \
          \  \"\"\"\n    ä» LLM è¾“å‡ºä¸­æå– JSON å¯¹è±¡\n    æ”¯æŒï¼š\n    - çº¯ JSON å­—ç¬¦ä¸²\n    - è¢«è½¬ä¹‰çš„\
          \ JSON\n    - å‰åå¸¦æ‚è´¨æ–‡æœ¬\n    \"\"\"\n\n    if not text:\n        return {}\n\
          \    text = text.strip()\n\n    # æƒ…å†µ 1ï¼šå·²ç»æ˜¯ JSON å¯¹è±¡å­—ç¬¦ä¸²\n    try:\n      \
          \  obj = json.loads(text)\n        if isinstance(obj, dict):\n         \
          \   return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ 2ï¼šè¢«è½¬ä¹‰çš„ JSON\
          \ å­—ç¬¦ä¸²\n    try:\n        unescaped = bytes(text, \"utf-8\").decode(\"unicode_escape\"\
          )\n        obj = json.loads(unescaped)\n        if isinstance(obj, dict):\n\
          \            return obj\n    except Exception:\n        pass\n\n    # æƒ…å†µ\
          \ 3ï¼šæ–‡æœ¬ä¸­åŒ…å« JSONï¼ˆæ­£åˆ™å…œåº•ï¼‰\n    match = re.search(r'\\{[\\s\\S]*\\}', text)\n\
          \    if match:\n        candidate = match.group(0)\n        try:\n     \
          \       return json.loads(candidate)\n        except Exception:\n      \
          \      pass\n\n    return {}\n\n# Dify Python èŠ‚ç‚¹éœ€è¦ main å‡½æ•°æ¥æ”¶è¾“å…¥å˜é‡\ndef main(raw_text:\
          \ str):\n    data = extract_json(raw_text)\n\n    # å¼ºåˆ¶å­—æ®µå…œåº•ï¼ˆé˜²æ­¢ä¸‹æ¸¸ç‚¸ï¼‰\n    final_markdown\
          \ = str(data.get(\"final_markdown\", \"\"))\n    \n    # æ·»åŠ é»˜è®¤å€¼ï¼Œç¡®ä¿ md_text\
          \ ä¸ä¸ºç©º\n    if not final_markdown:\n        final_markdown = \"# Dify Workflow\
          \ æŠ¥å‘Š\\n\\n## æŠ¥å‘Šå†…å®¹\\n\\nç”±äºè¾“å…¥å†…å®¹æˆ–LLMè¾“å‡ºé—®é¢˜ï¼Œæ— æ³•ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šã€‚è¯·æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°ä»¥è·å–å®Œæ•´æŠ¥å‘Šã€‚\\n\\\
          n## ç”Ÿæˆä¿¡æ¯\\n\\n- ç”Ÿæˆæ—¶é—´ï¼šè‡ªåŠ¨ç”Ÿæˆ\\n- æŠ¥å‘Šç±»å‹ï¼šé»˜è®¤æ¨¡æ¿\\n- å¤„ç†çŠ¶æ€ï¼šå·²å¤„ç†\\n- è¾“å…¥æƒ…å†µï¼šå·²æ¥æ”¶\\n\\n##\
          \ è§£å†³å»ºè®®\\n\\n1. æä¾›æ›´è¯¦ç»†çš„éœ€æ±‚æè¿°\\n2. ç¡®ä¿è¾“å…¥æ ¼å¼ç¬¦åˆè¦æ±‚\\n3. æ£€æŸ¥LLMæ¨¡å‹é…ç½®\\n4. é‡è¯•ç”ŸæˆæŠ¥å‘Š\" \n\
          \    \n    result = {\n        \"final_markdown\": final_markdown,\n   \
          \ }\n\n    return result\n"
        code_language: python3
        is_team_authorization: true
        outputs:
          final_markdown:
            children: null
            type: string
        selected: false
        title: å›½å†…AI json åŒ–å¤„ç†æ¨¡å—
        type: code
        variables:
        - value_selector:
          - '1769053876253'
          - text
          variable: raw_text
      height: 52
      id: '17690724297200'
      position:
        x: 977.1232375653808
        y: 549.11322133593
      positionAbsolute:
        x: 977.1232375653808
        y: 549.11322133593
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            value: å¼•ç”¨MCP
            variable_selector:
            - '1769050927522'
            - mode
          id: 'true'
          logical_operator: and
        - case_id: 'false'
          conditions:
          - comparison_operator: is
            value: ç¦æ­¢MCP
            variable_selector:
            - '1769050927522'
            - mode
          id: 'false'
          logical_operator: and
        default_next_node_id: '1769052218754'
        selected: false
        title: æ¡ä»¶åˆ†æ”¯
        type: if-else
      height: 171
      id: '1769073297193'
      position:
        x: 583.7463615443697
        y: 889.7869495917439
      positionAbsolute:
        x: 583.7463615443697
        y: 889.7869495917439
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 241
    viewport:
      x: 277.00885051446903
      y: -91.31114632087679
      zoom: 0.659753955386447
  rag_pipeline_variables: []
